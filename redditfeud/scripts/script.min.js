/*! redditfeud 21-11-2017 */

function filterDomains(a){var b=[];for(i=0;i<a.length;i++)for(j=0;j<IMAGE_DOMAINS.length;j++)if(a[i].data.domain===IMAGE_DOMAINS[j]&&!a[i].data.domain.endsWith(".gifv")&&!a[i].data.domain.endsWith(".gif")){b.push(a[i]);continue}return b}function init(){promise=fetchContent(SUBREDDITS[Math.floor(Math.random()*SUBREDDITS.length)]).then(function(a){LISTING=a.data.children},function(a){console.log(a)}),huh=[],huh.push(promise),Promise.all(huh).then(function(){LISTING=filterDomains(LISTING),picked=Math.floor(Math.random()*LISTING.length),pickedData=LISTING[picked].data,document.getElementById("image").innerHTML='<img src="'+pickedData.url+'" style="max-height:400px; max-width:auto;"/>',IMAGE_ID=pickedData.id,setContent()})}function setContent(){duplicatePromise=fetchDuplicates(IMAGE_ID).then(function(a){DUPLICATE_LISTING=a[0].data.children.concat(a[1].data.children),console.log(DUPLICATE_LISTING)},function(a){console.log(a)}),huh=[],huh.push(duplicatePromise),Promise.all(huh).then(function(){for(answers=[],i=0;i<DUPLICATE_LISTING.length;i++)items[i]=DUPLICATE_LISTING[i].data.subreddit,points[i]=DUPLICATE_LISTING[i].data.score,guessed[i]=!1,document.getElementById("item"+(i+1)).innerHTML="?";for(i=DUPLICATE_LISTING.length;i<8;i++)document.getElementById("item"+(i+1)).innerHTML="_"})}function textSubmit(a){"Enter"===event.key&&guess()}function guess(){for(input=document.getElementById("guess").value,i=0;i<items.length;i++)items[i].toUpperCase()!==input.toUpperCase()||guessed[i]||(document.getElementById("item"+(i+1)).innerHTML=items[i],document.getElementById("points"+(i+1)).innerHTML=points[i],guessed[i]=!0,score+=points[i],document.getElementById("score").innerHTML=score);document.getElementById("guess").value=""}function fetchContent(a){return url="https://www.reddit.com/r/",url=url.concat(a,"/top.json?sort=top&t=month"),fetch(url).then(function(a){if(a.status>=400)throw new Error("Bad response in fetchContent");return a.json()})}function fetchDuplicates(a){return url="https://www.reddit.com/duplicates/",url=url.concat(a,".json"),fetch(url).then(function(a){if(a.status>=400)throw new Error("Bad response in fetchContent");return a.json()})}var IMAGE_DOMAINS=["i.redd.it","i.imgur.com"],items=[],points=[],guessed=[],score=0,TEST=[["a",1],["b",2],["c",3],["d",4],["e",5],["f",6],["g",7],["h",8]],LISTING={},DUPLICATE_LISTING={},IMAGE_ID=0,SUBREDDITS=["woahdude","aww","nevertellmetheodds","blackpeopletwitter","bikinibottomtwitter","mildlyinteresting","niceguys","cringepics","facepalm","therewasanattempt","mildlyinfuriating","coaxedintoasnafu","madlads","crappydesign"];